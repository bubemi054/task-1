import React, { useState } from "react";
import {
  render,
  screen,
  fireEvent,
  waitFor,
  cleanup,
} from "@testing-library/react";
import CityWeatherCard from "./CityWeatherCard";
import { describe, vi, it, expect, afterEach } from "vitest";
import { City, WeatherResponse } from "../../state-manager/types";
import "@testing-library/jest-dom/vitest";

const mockWeatherResponse: WeatherResponse = {
  latitude: -3.25,
  longitude: -52.25,
  generationtime_ms: 0.125885009765625,
  utc_offset_seconds: 0,
  timezone: "GMT",
  timezone_abbreviation: "GMT",
  elevation: 102,
  // "location_id": 4,
  current_units: {
    time: "iso8601",
    interval: "seconds",
    temperature_2m: "°C",
    weathercode: "wmo code",
    wind_speed_10m: "km/h",
    precipitation: "mm",
    cloudcover: "%",
  },
  current: {
    time: "2025-03-17T22:00",
    interval: 900,
    temperature_2m: 26,
    weathercode: 80,
    wind_speed_10m: 5.7,
    precipitation: 0.1,
    cloudcover: 100,
  },
  hourly_units: {
    time: "iso8601",
    wind_speed_10m: "km/h",
    temperature_2m: "°C",
    relative_humidity_2m: "%",
    weathercode: "wmo code",
    precipitation: "mm",
    cloudcover: "%",
  },
  hourly: {
    time: [
      "2025-03-17T00:00",
      "2025-03-17T01:00",
      "2025-03-17T02:00",
      "2025-03-17T03:00",
      "2025-03-17T04:00",
      "2025-03-17T05:00",
      "2025-03-17T06:00",
      "2025-03-17T07:00",
      "2025-03-17T08:00",
      "2025-03-17T09:00",
      "2025-03-17T10:00",
      "2025-03-17T11:00",
      "2025-03-17T12:00",
      "2025-03-17T13:00",
      "2025-03-17T14:00",
      "2025-03-17T15:00",
      "2025-03-17T16:00",
      "2025-03-17T17:00",
      "2025-03-17T18:00",
      "2025-03-17T19:00",
      "2025-03-17T20:00",
      "2025-03-17T21:00",
      "2025-03-17T22:00",
      "2025-03-17T23:00",
      "2025-03-18T00:00",
      "2025-03-18T01:00",
      "2025-03-18T02:00",
      "2025-03-18T03:00",
      "2025-03-18T04:00",
      "2025-03-18T05:00",
      "2025-03-18T06:00",
      "2025-03-18T07:00",
      "2025-03-18T08:00",
      "2025-03-18T09:00",
      "2025-03-18T10:00",
      "2025-03-18T11:00",
      "2025-03-18T12:00",
      "2025-03-18T13:00",
      "2025-03-18T14:00",
      "2025-03-18T15:00",
      "2025-03-18T16:00",
      "2025-03-18T17:00",
      "2025-03-18T18:00",
      "2025-03-18T19:00",
      "2025-03-18T20:00",
      "2025-03-18T21:00",
      "2025-03-18T22:00",
      "2025-03-18T23:00",
      "2025-03-19T00:00",
      "2025-03-19T01:00",
      "2025-03-19T02:00",
      "2025-03-19T03:00",
      "2025-03-19T04:00",
      "2025-03-19T05:00",
      "2025-03-19T06:00",
      "2025-03-19T07:00",
      "2025-03-19T08:00",
      "2025-03-19T09:00",
      "2025-03-19T10:00",
      "2025-03-19T11:00",
      "2025-03-19T12:00",
      "2025-03-19T13:00",
      "2025-03-19T14:00",
      "2025-03-19T15:00",
      "2025-03-19T16:00",
      "2025-03-19T17:00",
      "2025-03-19T18:00",
      "2025-03-19T19:00",
      "2025-03-19T20:00",
      "2025-03-19T21:00",
      "2025-03-19T22:00",
      "2025-03-19T23:00",
      "2025-03-20T00:00",
      "2025-03-20T01:00",
      "2025-03-20T02:00",
      "2025-03-20T03:00",
      "2025-03-20T04:00",
      "2025-03-20T05:00",
      "2025-03-20T06:00",
      "2025-03-20T07:00",
      "2025-03-20T08:00",
      "2025-03-20T09:00",
      "2025-03-20T10:00",
      "2025-03-20T11:00",
      "2025-03-20T12:00",
      "2025-03-20T13:00",
      "2025-03-20T14:00",
      "2025-03-20T15:00",
      "2025-03-20T16:00",
      "2025-03-20T17:00",
      "2025-03-20T18:00",
      "2025-03-20T19:00",
      "2025-03-20T20:00",
      "2025-03-20T21:00",
      "2025-03-20T22:00",
      "2025-03-20T23:00",
      "2025-03-21T00:00",
      "2025-03-21T01:00",
      "2025-03-21T02:00",
      "2025-03-21T03:00",
      "2025-03-21T04:00",
      "2025-03-21T05:00",
      "2025-03-21T06:00",
      "2025-03-21T07:00",
      "2025-03-21T08:00",
      "2025-03-21T09:00",
      "2025-03-21T10:00",
      "2025-03-21T11:00",
      "2025-03-21T12:00",
      "2025-03-21T13:00",
      "2025-03-21T14:00",
      "2025-03-21T15:00",
      "2025-03-21T16:00",
      "2025-03-21T17:00",
      "2025-03-21T18:00",
      "2025-03-21T19:00",
      "2025-03-21T20:00",
      "2025-03-21T21:00",
      "2025-03-21T22:00",
      "2025-03-21T23:00",
      "2025-03-22T00:00",
      "2025-03-22T01:00",
      "2025-03-22T02:00",
      "2025-03-22T03:00",
      "2025-03-22T04:00",
      "2025-03-22T05:00",
      "2025-03-22T06:00",
      "2025-03-22T07:00",
      "2025-03-22T08:00",
      "2025-03-22T09:00",
      "2025-03-22T10:00",
      "2025-03-22T11:00",
      "2025-03-22T12:00",
      "2025-03-22T13:00",
      "2025-03-22T14:00",
      "2025-03-22T15:00",
      "2025-03-22T16:00",
      "2025-03-22T17:00",
      "2025-03-22T18:00",
      "2025-03-22T19:00",
      "2025-03-22T20:00",
      "2025-03-22T21:00",
      "2025-03-22T22:00",
      "2025-03-22T23:00",
      "2025-03-23T00:00",
      "2025-03-23T01:00",
      "2025-03-23T02:00",
      "2025-03-23T03:00",
      "2025-03-23T04:00",
      "2025-03-23T05:00",
      "2025-03-23T06:00",
      "2025-03-23T07:00",
      "2025-03-23T08:00",
      "2025-03-23T09:00",
      "2025-03-23T10:00",
      "2025-03-23T11:00",
      "2025-03-23T12:00",
      "2025-03-23T13:00",
      "2025-03-23T14:00",
      "2025-03-23T15:00",
      "2025-03-23T16:00",
      "2025-03-23T17:00",
      "2025-03-23T18:00",
      "2025-03-23T19:00",
      "2025-03-23T20:00",
      "2025-03-23T21:00",
      "2025-03-23T22:00",
      "2025-03-23T23:00",
    ],
    wind_speed_10m: [
      1.5, 1.5, 1.6, 2.4, 4.8, 5.9, 5.7, 5.4, 6.2, 4.8, 3.9, 4.2, 5.2, 4.7, 3.3,
      3.6, 4.9, 4.6, 4.4, 3.1, 3.2, 6.5, 5.7, 3.7, 2.8, 2.4, 1.3, 2.2, 3.1, 3.3,
      3.5, 4.2, 3.9, 3.6, 3.8, 3.9, 4.2, 3.9, 3.1, 3.1, 4.5, 5.8, 6, 4.7, 5.2,
      5.5, 4.4, 4.9, 4.4, 3.7, 3.2, 2.2, 2.6, 2.3, 2.2, 2.5, 2.7, 2.5, 2.2, 3.7,
      5.9, 7.9, 7.4, 6.4, 4.5, 4.5, 5.2, 5.5, 8.4, 6.6, 3.2, 2.2, 2.6, 2.4, 2.2,
      3.3, 2.9, 2.2, 2.1, 2.1, 2.7, 4.3, 3.6, 4.3, 5.6, 7.1, 5.7, 6.7, 5.1, 6.4,
      7.1, 6.8, 6.4, 5.4, 4.3, 1.8, 2.7, 2.7, 3.1, 3.6, 4.1, 5.2, 5.8, 5.8, 5.5,
      5.7, 6.4, 7.6, 8.7, 9.4, 10.2, 10.5, 9.8, 8.8, 7.5, 6.4, 5.4, 4.8, 5.1,
      5.9, 6.4, 6.6, 6.5, 6.8, 7, 6.9, 6.6, 5.4, 3.4, 2.7, 3.9, 6, 7.6, 8.4,
      9.2, 9.6, 9, 8.2, 7.5, 6.9, 7.2, 7.1, 5.6, 3.4, 2.3, 2.1, 3.1, 4.2, 5.2,
      6.2, 6.7, 6.4, 5.1, 4.8, 5.4, 6.1, 6.9, 7.4, 8.3, 8.4, 8.2, 7.4, 6.8, 6.4,
      6.2, 5.8, 4.7, 3.1,
    ],
    temperature_2m: [
      25, 24.9, 24.8, 24.7, 24.7, 24.2, 23.8, 23.7, 23.6, 23.5, 23.6, 24.1,
      25.2, 25.7, 26.9, 27.5, 28, 28.4, 29.9, 29.6, 28.9, 27.5, 26.1, 25.4,
      24.9, 24.7, 24.6, 24.4, 24.2, 23.9, 23.7, 23.5, 23.5, 23.4, 23.4, 23.8,
      24.2, 24.6, 25, 25.6, 26.3, 26.6, 26.4, 26.2, 26.5, 26.4, 25.3, 24.7,
      24.4, 24.1, 23.9, 23.6, 23.3, 23, 22.8, 22.7, 22.8, 22.9, 22.9, 24, 24.6,
      25.7, 26.3, 26.7, 27.5, 27.6, 27.5, 27.8, 26.8, 25.8, 25.2, 24.8, 24.6,
      24.3, 24.1, 24, 23.8, 23.4, 23.1, 23, 23.1, 23.4, 23.4, 23.9, 24.5, 25.4,
      26.7, 27.4, 28.2, 29.2, 29.2, 28.7, 28.4, 27.6, 26.3, 25.6, 25.4, 25,
      24.8, 24.6, 24.3, 24, 23.8, 23.6, 23.4, 23.4, 23.6, 24, 24.7, 26, 27.6,
      28.9, 29.7, 30.2, 30.4, 30, 29.2, 28.4, 27.6, 26.8, 26.1, 25.6, 25.2,
      24.8, 24.5, 24.2, 23.9, 23.7, 23.5, 23.6, 23.9, 24.5, 25.2, 25.9, 26.6,
      27.2, 27.7, 28.1, 28.4, 28.5, 27.8, 27.1, 26.4, 25.7, 25.1, 24.8, 24.7,
      24.5, 24.3, 24, 23.8, 23.6, 23.5, 23.5, 23.7, 24.1, 24.6, 25.2, 26, 26.7,
      27.5, 28.2, 28.5, 28.2, 27.4, 26.7, 26.2, 25.7,
    ],
    relative_humidity_2m: [
      90, 90, 91, 92, 92, 94, 93, 94, 92, 92, 92, 91, 88, 87, 83, 80, 77, 76,
      69, 69, 73, 79, 84, 87, 90, 91, 91, 91, 92, 93, 93, 93, 92, 93, 93, 91,
      90, 90, 90, 89, 85, 84, 84, 83, 81, 81, 88, 92, 94, 95, 96, 96, 97, 98,
      100, 100, 100, 99, 99, 95, 92, 87, 84, 82, 80, 78, 78, 77, 81, 85, 89, 91,
      92, 94, 94, 95, 96, 98, 98, 99, 98, 97, 94, 91, 88, 83, 78, 76, 74, 70,
      69, 72, 74, 77, 83, 88, 88, 90, 90, 91, 91, 92, 92, 93, 93, 93, 92, 91,
      88, 82, 75, 69, 66, 65, 65, 67, 70, 74, 78, 82, 85, 87, 89, 90, 91, 91,
      92, 93, 95, 95, 94, 92, 90, 87, 83, 80, 77, 75, 74, 75, 78, 82, 85, 89,
      91, 92, 93, 93, 93, 94, 94, 94, 94, 94, 93, 92, 91, 89, 86, 83, 79, 76,
      74, 75, 79, 82, 85, 88,
    ],
    weathercode: [
      3, 3, 3, 3, 3, 3, 3, 3, 80, 95, 80, 80, 80, 80, 3, 3, 3, 80, 3, 3, 95, 95,
      80, 80, 95, 95, 95, 95, 80, 3, 80, 95, 95, 95, 95, 95, 95, 95, 95, 80, 3,
      80, 95, 80, 3, 3, 3, 3, 3, 3, 3, 45, 45, 45, 45, 45, 45, 45, 45, 80, 95,
      3, 3, 80, 3, 80, 95, 3, 95, 80, 3, 3, 3, 3, 3, 3, 80, 45, 45, 45, 45, 3,
      3, 3, 3, 3, 3, 3, 80, 3, 3, 3, 3, 3, 80, 80, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3,
      3, 3, 3, 3, 3, 3, 3, 3, 3, 80, 80, 80, 80, 80, 80, 95, 95, 95, 95, 95, 95,
      3, 3, 3, 80, 80, 80, 3, 3, 3, 80, 80, 80, 95, 95, 95, 3, 3, 3, 95, 95, 95,
      95, 95, 95, 3, 3, 3, 80, 80, 80, 3, 3, 3, 3, 3, 3, 2, 2, 2, 80, 80,
    ],
    precipitation: [
      0, 0, 0, 0, 0.1, 0, 0, 0, 0.4, 0.8, 0.4, 0.5, 0.6, 0.4, 0.2, 0.1, 0.1,
      0.2, 0.1, 0.1, 0.8, 1.4, 0.5, 0.7, 1.1, 0.9, 1.7, 1.6, 0.2, 0, 0.6, 1.4,
      1.2, 1.2, 1.6, 1.7, 1.1, 0.9, 1, 0.7, 0.1, 0.5, 0.8, 0.5, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5, 0.8, 0.1, 0.1, 0.4, 0.2, 0.4, 0.9, 0.2,
      1.2, 0.5, 0, 0, 0, 0, 0, 0.1, 0.4, 0, 0, 0, 0, 0, 0, 0, 0, 0.2, 0.1, 0.2,
      0.2, 0, 0, 0.1, 0.1, 0.1, 0.3, 0.3, 0, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0, 0,
      0, 0, 0, 0, 0.1, 0.1, 0.1, 0, 0, 0, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 1.5,
      1.5, 1.5, 1.4, 1.4, 1.4, 0.7, 0.7, 0.7, 0.3, 0.3, 0.3, 0.2, 0.2, 0.2, 0.2,
      0.2, 0.2, 1.4, 1.4, 1.4, 1.1, 1.1, 1.1, 0.6, 0.6, 0.6, 1.5, 1.5, 1.5, 0.3,
      0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.1, 0.1, 0.1, 0.6, 0.6, 0.6, 0.7,
      0.7,
    ],
    cloudcover: [
      100, 100, 100, 100, 100, 100, 100, 100, 100, 99, 100, 100, 100, 100, 100,
      100, 96, 93, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100,
      100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 95, 90,
      84, 86, 100, 97, 97, 92, 86, 59, 82, 100, 100, 100, 100, 100, 100, 100,
      100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100,
      100, 100, 100, 100, 100, 100, 100, 100, 99, 87, 95, 93, 100, 100, 100,
      100, 100, 88, 84, 75, 72, 73, 74, 75, 81, 87, 93, 93, 92, 92, 92, 92, 92,
      92, 93, 93, 92, 91, 90, 93, 97, 100, 100, 100, 100, 100, 100, 100, 100,
      100, 100, 97, 93, 90, 92, 94, 96, 95, 94, 93, 95, 98, 100, 99, 99, 100,
      100, 100, 100, 100, 100, 100, 100, 100, 100, 99, 99, 98, 97, 96, 95, 97,
      98, 100, 100, 100, 100, 86, 71, 57, 71, 86,
    ],
  },
  name: "Altamira",
  country: "Brazil",
  area_km2: 159533,
  lat: -3.203,
  lon: -52.206,
  address: "Altamira, Pará, Brazil",
};

const mockToggleFavorite = vi.fn();
const mockToggleRemoved = vi.fn();

function ControlledCityWeatherCard({
  isFavorite = false,
}: {
  isFavorite: boolean;
}) {
  return (
    <CityWeatherCard
      weatherResponse={mockWeatherResponse}
      toggleFavorite={mockToggleFavorite}
      toggleRemoved={mockToggleRemoved}
      isFavorite={isFavorite}
    />
  );
  // <BrowserRouter>
  // </BrowserRouter>
}

afterEach(cleanup);

describe("CityWeatherCard", () => {
  it("renders city name and temperature correctly", () => {
    render(<ControlledCityWeatherCard isFavorite={false} />);
    // expect(screen.getByText("Lagos")).toBeInTheDocument();
    // expect(screen.getByText("30°C")).toBeInTheDocument();
  });
});
